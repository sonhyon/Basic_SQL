#앞 또는 뒤 행을 참조하는 함수 - LAG, LEAD
SELECT X.PAYMENT_DATE,
  LAG(X.AMOUNT) OVER(ORDER BY X.PAYMENT_DATE ASC) AS LAG_AMOUNT, AMOUNT,
  LEAD(X.AMOUNT) OVER(ORDER BY X.PAYMENT_DATE ASC) AS LEAD_AMOUNT
FROM () AS X
ORDER BY X.PAYMENT_DATE;

SELECT X.PAYMENT_DATE, #LAG와 LEAD 함수로 2칸씩 앞뒤 행 참조
  LAG(X.AMOUNT, 2) OVER(ORDER BY X.PAYMENT_DATE ASC) AS LAG_AMOUNT, AMOUNT,
  LEAD(X.AMOUNT, 2) OVER(ORDER BY X.PAYMENT_DATE ASC) AS LEAD_AMOUNT
FROM () AS X
ORDER BY X.PAYMENT_DATE;

#누적 분포를 계산하는 함수 - CUME_DIST
SELECT X.CUSTOMER_ID, X.AMOUNT, CUME_DIST() OVER(ORDER BY X.AMOUNT DESC)
FROM () AS X
ORDER BY X.AMOUNT DESC;

#상대 순위를 계산하는 함수 - PERCENT_RANK
SELECT X.CUSTOMER_ID, X.AMOUNT, PERCENT_RANK() OVER (ORDER BY X.AMOUNT DESC)
FROM () AS X;
ORDER BY X.AMOUNT DESC;

#첫 행 또는 마지막 행의 값을 구하는 함수 - FIRST_VALUE, LAST_VALUE
SELECT X.PAYMENT_DATE, X.AMOUNT,
  FIRST_VALUE(X.AMOUNT) OVER(ORDER BY X.PAYMENT_DATE) AS F_VALUE,
  LAST_VALUE(X.AMOUNT) OVER(ORDER BY X.PAYMENT_DATE RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLWING) AS L_VALUE
FROM () AS X
ORDER BY X.PAYMENT_DATE;
